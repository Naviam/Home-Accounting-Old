(function(a){a.tools=a.tools||{version:"@VERSION"};var i;i=a.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:true,closeOnEsc:true,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};function h(){if(a.browser.msie){var b=a(document).height(),c=a(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,b-c<20?c:b]}return[a(document).width(),a(document).height()]}function g(b){if(b)return b.call(a.mask)}var b,f,c,d,e;a.mask={load:function(j,k){if(c)return this;if(typeof j=="string")j={color:j};j=j||d;d=j=a.extend(a.extend({},i.conf),j);b=a("#"+j.maskId);if(!b.length){b=a("<div/>").attr("id",j.maskId);a("body").append(b)}var l=h();b.css({position:"absolute",top:0,left:0,width:l[0],height:l[1],display:"none",opacity:j.startOpacity,zIndex:j.zIndex});j.color&&b.css("backgroundColor",j.color);if(g(j.onBeforeLoad)===false)return this;j.closeOnEsc&&a(document).bind("keydown.mask",function(b){b.keyCode==27&&a.mask.close(b)});j.closeOnClick&&b.bind("click.mask",function(b){a.mask.close(b)});a(window).bind("resize.mask",function(){a.mask.fit()});if(k&&k.length){e=k.eq(0).css("zIndex");a.each(k,function(){var b=a(this);!/relative|absolute|fixed/i.test(b.css("position"))&&b.css("position","relative")});f=k.css({zIndex:Math.max(j.zIndex+1,e=="auto"?0:e)})}b.css({display:"block"}).fadeTo(j.loadSpeed,j.opacity,function(){a.mask.fit();g(j.onLoad);c="full"});c=true;return this},close:function(){if(c){if(g(d.onBeforeClose)===false)return this;b.fadeOut(d.closeSpeed,function(){g(d.onClose);f&&f.css({zIndex:e});c=false});a(document).unbind("keydown.mask");b.unbind("click.mask");a(window).unbind("resize.mask")}return this},fit:function(){if(c){var a=h();b.css({width:a[0],height:a[1]})}},getMask:function(){return b},isLoaded:function(a){return a?c=="full":c},getConf:function(){return d},getExposed:function(){return f}};a.fn.mask=function(b){a.mask.load(b);return this};a.fn.expose=function(b){a.mask.load(b,this);return this}})(jQuery)