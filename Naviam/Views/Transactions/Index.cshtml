@{
    ViewBag.Title = "Transactions";
    Layout = "~/Views/Shared/LayoutMember.cshtml";
}
@*intellisense support*@
@if (false)
{ 
    <script type="text/javascript" src="~/Scripts/jquery-1.6.2.js"></script> 
    <script type="text/javascript" src="~/Scripts/knockout-1.2.1.js"></script> 
    <script type="text/javascript" src="~/Scripts/knockout.mapping.js"></script> 
}

<script type='text/javascript'>

    //JSON.stringify
    var transModel = {
        paging: { Page: 1 }
        };
    $(document).ready(function () {
        $.postErr('@Url.Action("GetTransactions", "Transactions")', transModel.paging, function (res) {
            transModel = ko.mapping.fromJS(res);
            transModel.paging.Page.subscribe(function (newValue) {
                transModel.ReloadPage();
            });
            transModel.ReloadPage = function(){
                $.postErr('@Url.Action("GetTransactions", "Transactions")', transModel.paging, function (res) {
                    ko.mapping.updateFromJS(transModel, res);
                });
            }
            ko.applyBindings(transModel, $("#transGrid")[0]);
        });
    });
</script>

<a href="#" onclick='return transModel.ReloadPage();'>Refresh</a>

<script type="text/html" id="transRowTemplate">
    <tr>
        <td><span data-bind="text: Description"></span></td>
        <td><span data-bind="text: Category"></span></td>
        <td><span data-bind="text: Amount"></span></td>
    </tr>
</script>
<script type="text/html" id="transPagingTemplate">
    <span>Page:</span>
    {{each(i) ko.utils.range(1, paging.PagesCount)}}
        <a href="#" data-bind="click: function() { paging.Page(i+1) }, css: { selected: i+1 == paging.Page() }">
            ${ i + 1 }
        </a>
    {{/each}}
</script>

<div id="transGrid">
    <table>
        <thead>
            <tr>
                <th>Description</th>
                <th>Category</th>
                <th>Amount</th>
            </tr>
        </thead>
        <tbody data-bind='template: { name: "transRowTemplate", foreach: items }'></tbody>
    </table>
    <div data-bind='template: "transPagingTemplate"' class='paging'></div>
</div> 




